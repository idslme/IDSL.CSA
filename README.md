# IDSL.CSA <img src='CSA_educational_files/Figures/IDSL.CSA-logo.PNG' width="250px" align="right" />

<!-- badges: start -->
[![Maintainer](https://img.shields.io/badge/maintainer-Sadjad_Fakouri_Baygi-blue)](https://github.com/sajfb)
[![CRAN status](https://www.r-pkg.org/badges/version/IDSL.CSA)](https://cran.r-project.org/package=IDSL.CSA)
![](http://cranlogs.r-pkg.org/badges/IDSL.CSA?color=orange)
![](http://cranlogs.r-pkg.org/badges/grand-total/IDSL.CSA?color=brightgreen)
[![Dependencies](https://tinyverse.netlify.com/badge/IDSL.CSA)](https://cran.r-project.org/package=IDSL.CSA)
<!-- badges: end -->

**Composite Spectra Analysis (CSA)** by the [**Integrated Data Science Laboratory for Metabolomics and Exposomics (IDSL.ME)**](https://www.idsl.me/) is an R package designed to deconvolute fragmentation spectra from Composite Spectra Analysis (CSA), Data Dependent Acquisition (DDA), and various Data-Independent Acquisition (DIA) methods such as MS<sup>E</sup>, and All-Ion Fragmentation (AIF).

## Table of Contents

- [Features of IDSL.CSA](https://github.com/idslme/IDSL.CSA#features-of-idslcsa)
- [Installation](https://github.com/idslme/IDSL.CSA#installation)
- [Workflow](https://github.com/idslme/IDSL.CSA#workflow)
- [Simple Batch Example](https://github.com/idslme/IDSL.CSA#simple-batch-example)
- [Wiki](https://github.com/idslme/IDSL.CSA#wiki)
- [Citation](https://github.com/idslme/IDSL.CSA#citation)

## Features of IDSL.CSA

1) Parameter selection through a well-described [parameter spreadsheet](https://raw.githubusercontent.com/idslme/IDSL.CSA/main/CSA_parameters.xlsx)
2) Process high-throughput and population size studies (n > 500)
3) Generating pairwise correlations list for aligned peak height and its gap-filled tables to detect potential recurring adducts, in-source products and fragment peaks
4) Compatibility with parallel processing in Windows and Linux environments

## Installation

	install.packages("IDSL.CSA")

## Workflow

Prior to processing your mass spectrometry data (**mzXML**, **mzML**, **netCDF**) using the IDSL.CSA workflow, mass spectrometry data should be processed using the [IDSL.IPA](https://github.com/idslme/IDSL.IPA) workflow to acquire chromatographic information of the peaks (***m/z-RT***). When the chromatographic information of individual and aggregated aligned peaklists were generated using the [IDSL.IPA](https://github.com/idslme/IDSL.IPA) workflow, download the [IDSL.CSA parameter spreadsheet](https://raw.githubusercontent.com/idslme/IDSL.CSA/main/CSA_parameters.xlsx) and select the parameters accordingly and then use this spreadsheet as the input for the IDSL.CSA workflow:

	library(IDSL.CSA)
	IDSL.CSA_workflow("Address of the CSA parameter spreadsheet")

## Quick Batch Example

Follow these steps for a quick case study (n=33) [ST002263](https://www.metabolomicsworkbench.org/data/DRCCMetadata.php?Mode=Study&StudyID=ST002263&DataMode=AllData&ResultType=1) which has Thermo Q Exactive HF hybrid Orbitrap data collected in the HILIC-ESI-POS/NEG modes. 

1. Process raw mass spectrometry data and chromatographic information using the method described by [IDSL.IPA](https://github.com/idslme/IDSL.IPA#quick-batch-example)

2. IDSL.CSA requires 39 parameters distributed into 5 separate sections. For this study, use default parameter values presented in the [CSA parameter spreadsheet](https://raw.githubusercontent.com/idslme/IDSL.CSA/main/CSA_parameters.xlsx). Next, Provide address for 
	
	2.1. Select **YES** for **PARAM0001** in the `Start` tab
	
	2.2. **CSA0005** for *HRMS data location address (MS1 level HRMS data)*
	
	2.3. **CSA0008** for *Address of the `peaklists` directory generated by the IDSL.IPA workflow*
	
	2.4. **CSA0009** for *Address of the `peak_alignment` directory generated by the IDSL.IPA workflow*
	
	2.5. **CSA0011** for *Output location (.msp files and EICs)*
	
	2.6. You may also increase the number of processing threads using **CSA0004** according to your computational power

3. Run this command in R/Rstudio console or terminal: `IDSL.CSA::CSA_workflow("Address of the CSA parameter spreadsheet")`

4. You may parse the results at the address you provided for **CSA0011**.

## [**Wiki**](https://github.com/idslme/IDSL.CSA/wiki)

1. [**CSA analysis by IDSL.CSA**](https://github.com/idslme/IDSL.CSA/wiki/CSA-analysis-by-IDSL.CSA)
2. [**DDA analysis by IDSL.CSA**](https://github.com/idslme/IDSL.CSA/wiki/DDA-analysis-by-IDSL.CSA)
3. [**DIA analysis by IDSL.CSA**](https://github.com/idslme/IDSL.CSA/wiki/DIA-analysis-by-IDSL.CSA)
4. [**unique spectra aggregation**](https://github.com/idslme/IDSL.CSA/wiki/Unique-spectra-aggregation)

## Citation

pending...